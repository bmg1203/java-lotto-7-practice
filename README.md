# java-lotto-precourse

## 3주차 - 로또

* * *

##### 어떤 프로그램인가?

이 프로그램의 목적은 로또를 구매하는 과정을 자동화하여 결과를 분석하는 것이다. 다만, 일반적인 복권의 당첨 기준과 가격은 똑같이하되, 차이점이 존재한다.   
   
- 구매한 로또의 번호는 수동으로 선택이 불가능하며, 자동선택이다.   
- 구매한 로또의 번호가 나온 뒤에 사용자가 당첨번호와 보너스 번호를 입력할 수 있다. 단, 당첨번호는 한 번에 6개의 번호를 쉼표(,)를 기준으로 입력하고 보너스 번호를 포함한 7개의 번호는 중복되지 않아야한다.   
- 로또를 구입할 시 입력 금액은 반드시 1000으로 나누어 떨어져야한다.
- 0원으로 로또를 구매하는 것은 성립하지 않는다.
- 1등부터 3등까의 당첨금액은 일반적인 로또의 상금 분배 방식인 구매한 총 기금의 일부분을 동일한 등수의 당첨자끼리 균등하게 분배하는 것이 아닌 고정된 금액인 20억원, 3천만원, 150만원으로 분배한다. 
- 1회차당 1인 최대 10만원 구매 제한을 허용한다. 즉 10만원을 초과하여 구매할 수 있다.   
- 수익률은 원금 대비 수익의 변화로 표시하지 않고 (총 당첨 금액) / (원금)으로 계산한다.   
    
   
* * *
   
   
##### 어떻게 구현할 것인가?
사전에 구현이 되어있는 클래스는 프로그램을 진행하는 메인 메서드가 있는 Application과 Lotto 클래스이다. 이때 Lotto의 경우 별도의 필드 추가 및 접근 제어자를 추가할 수 없다.
- 그렇기에 Lotto 클래스에서 담을 수 있는 것은 validate를 통해 검증된 값인 Integer자료형 변수를 담은 크기가 6인 배열 뿐이다
- 이는 따라서 구매한 로또의 번호를 저장하고 로또에 관련된 메세지를 처리하는 객체에 적합하다.
    + 예상되는 외부의 호출
        * OutputView에 의해 구매한 로또의 번호를 보여줘야할 때
        * 사용자가 입력한 로또 번호와 비교하여 결과를 출력해야할 때
            이때 입력 파라미터로는 선택한 번호 6개와 보너스 번호 1개를 받는다.
- 그 외에도 다음과 같은 기능이 필요하다
    - 입력을 담당하는 클래스
    - 출력을 담당하는 클래스
    - 입력된 문자열 및 정수를 검증하는 클래스
    - 입력된 값을 바탕으로 나눈뒤 저장하는 클래스
    - 입력한 금액과 구매한 로또, 당첨번호와 당첨금을 관리하는 모델 클래스
    - 입력된 금액을 검증하는 클래스
    - 로또를 구매하는 클래스
    - 로또에 당첨된 금액을 처리하는 클래스
    
   
* * *
   
   
##### 이떻게 사용하는 것이 좋을까?
1. 2주차까지의 미션은 validator와 exceptor를 따로 패키지를 만들어서 관리하였다. 그러나 이런 로직이 많아질 경우 관리하기 어렵다는 단점이 있다. 이번주의 검증과 예외는 어떻게 처리할 것인가?
    - 이번 주의 검증할 것 중, 중복으로 같은 과정을 검증하는 경우가 많다. 예를 들어 구매한 로또 번호가 6개인지, 같은 수가 있는지를 검증하는 것은 당점번호를 작성할 때와 검사해야할 것이 같다. 또한 구매한 숫자의 범위나 구매할 금액을 입력할 때도 두 경우 모두 문자열이  들어갔는지를 검사하는 로직이 있다. 이는 다시 말해 앞선 2개의 미션과 다르게 한 Validation이 다른 로직에서도 여러 번 재활용할 여지가 충분하다는 것이다. 그렇기에 앞선 미션에서 validator를 별도로 분리하는 것은 의문이 있겠으나, 이번 미션에서는 메서드의 재활용을 위하여 validator 패키지에서 static 메서드로 호출하는 것이 수행에 유리하다.    
   
2. 3주차의 상수는 Java ENUM으로 처리하라는 조건이 있다. 상수 대신에 Enum을 썼을 때의 이점은 무엇인가?
    - 문제의 조건에서 나올 수 있는 등수는 1~5등과 낙첨으로 표현할 수 있다. 그런데 만약에 이것을 int 변수형으로 표현했다면 낙첨의 의미를 표현할 수 없다. 또한 상수로 이것을 관리한다고 해도 상수에서 새로운 범위를 추가할 때 별도의 과정이 필요하고 타입의 안정성의 문제가 있다. 만약 Enum으로 선언한다면 Enum 클래스에 가능한 범위가 제한이 되고, 그에 따른 값을 쉽게 호출할 수 있다는 장점이 있다. 
    
3. MVC패턴을 이번 미션에서는 반드시 따라야하는가?
    - 앞선 2개의 미션과 다르게 이번 미션에는 각각의 기능이 확실하게 구분이 가능하다. 입력과 출력을 받는 클래스, 개별적인 정보와 전반적인 시스템의 정보를 가지고 있는 클래스, 또한 프로그램 내부에서 동작을 수행하는 클래스가 존재하고 이는 각각 View, Model, Controller에 해당한다. 다만 프리코스의 과정에서 특정 패턴을 전략적으로 사용하기보다는 환경과 조건에 맞는 구분이 필요하다고 생각한다. 그렇기에 MVC패턴을 의도적으로 사용하기보다는 의식하되 각 패키지가 구분을 확실히 하도록 짜는 것이 좋겠다.
    
4. TestCase를 작성하기 위한 메서드는 어떻게 짤 것인가?
    - 2주차의 TC에서 앞으로 나아가는 것을 구현하는 것 자체는 쉬웠으나, 이것을 테스트 하기가 어려웠다. 객체를 생성하고 계속 랜덤 4 이상의 숫자를 넣어주기에는 너무 많은 기능을 테스트하고있다. 이의 해결 방법은 간단하다. 단일 책임 원칙을 고수하는 것이다. 지금껏 앞으로 나아가는 것을 테스트하지 못한 이유는 특정 조건 이상이어야 앞으로 나아갈 수 있다. 이는 다시 말해 만약 앞으로 나간다는 메서드를 만들고 움직이는 메서드에 조건을 검사하는 메서드와 앞으로 나아가는 메서드를 연달아 배치한다면 조건을 만족했을 때 뿐만 아니라 그러지 않을 때도 검사가 가능하다. 움직임()이 아닌 앞으로()만 호출하면 되기 때문이다. 그렇기에 최소 기능을 만들고 검증이 가능해진다. 따라서 TC를 위해서는 최대한 단일한 기능을 하도록 분할이 필요하다.

* * *

##### 어떤 기능을 만들까?
   
1. 값을 입력받는 메서드
    - 입력 받는 값은 3가지로, 구입할 금액, 당첨 번호, 보너스번호이다.
        - 구입할 금액 예외사항: 문자열이 들어온 경우, 실수가 들어온 경우, 금액이 0 이하의 정수인 경우, 금액이 1000으로 나누어 떨어지지 않는 경우(매직 넘버X)
        - 당첨번호 예외사항 : 문자열이 들어온 경우, 실수가 들어온 경우, 번호가 1-45 범위 외인 경우, 번호가 중복되는 경우(세트로 구현 가능)
        - 보너스번호 예외사항 : 문자열이 들어온 경우, 실수가 들어온 경우, 번호가 1-45 범위 외인 경우, 번호가 중복되는 경우(당첨번호와 달리 당첨번호의 각 객체를 비교해야 구현 가능)
    - 예외사항에 문자열, 실수, 범위는 같은 검증 체계를 사용할 수 있다.

2. 값을 출력하는 메서드
    - 출력하는 값은 프로그램이 안내하는 메시지, 로또 번호, 당첨 통계이다.
        - 출력하는 값 고려할 사항 : 빈칸을 잘 출력했는가? 예시와 같은 결과를 출력하는가? 파라미터를 사용해야하는 경우 어떻게 고려할 것인가?(로또 개수 + 구매했습니다. , Enum 객체의 값 반환 등)

3. 값을 관리하는 메서드
    - 관리해야할 값 : 구매한 로또, 로또를 구매한 개수(입력한 금액), 입력한 당첨번호, 입력한 보너스 번호, 등수별 당첨 횟수, 총 상금
        - 고려할 사항
            - 만약에 1등에 50억번 당첨된다면?(long long 범위 초과)
            - (그렇게 안되게 프로그램을 작성하겠지만) 데이터 변조가 일어나서 1등의 횟수가 조작됐다면 어떻게 검증할 것인가?
            - 총 당첨 금액을 변수로 저장하는게 나은가? 아니면 등수별 당첨횟수가 있으니 별도로 변수로 관리할 필요가 없는가? 
            - outputView에 어떻게 변수를 전달할 것인가?

4. Enum 객체
    - 관리할 값 : 등수와 그에 따른 상금 금액, 출력할 메시지
        - 고려할 사항
            - 상태에는 '당첨되지 않음'이 있다. 이는 당청금을 0으로 가져야한다
            - 출력할 메시지를 상수처럼 enum객체에 넣어서 관리할 수 있다.
            - 현재 고려한 값 외의 다른 상수를 enum으로 관리할 것인가? magic number는 상수로 관리해도 괜찮은가?(ex. 1000, 1, 45, 6)

5. 객체 검증
    - 검증하는 사항
        - 로또가 6개가 들어왔는가?
        - 입력한 번호에 중복은 없는가?
        - 입력한 값이 정수인가?
        - 입력한 값이 조건에 맞는가?
        - 결과가 맞는가?

6. 유틸
    - 구현할 기능 
        - 문자열을 파싱하여 Integer 배열로 반환하기
        - 로또 생성하기
        - 당첨번호와 보너스번호를 전달하기
        - 등수 조회하기
        - 분석이 끝났으면 결과 조회하기

* * *   
##### 어떻게 구현하였는가?   
이번 프로그램은 5개의 패키지, 14개의 클래스로 구성이 되어있다.   
   
	+---lotto
	|       Application.java
	|       LottoController.java
	|
	+---view
	|       OutputView.java
	|       OutputMessages.java
	|       InputView.java
	|
	+---validator
	|       Validator.java
	|
	+---utils
	|       Pair.java
	|       LottoNumbersGenerator.java
	|       Parser.java
	|       Converter.java
	|       LottoFactory.java
	|
	\---model
        	Lotto.java
        	Status.java
        	LottoResult.java

###### lotto 패키지   
	- Application : 프로그램을 실행하는 메인함수 클래스   
	- LottoController : 프로그램의 주 동작을 실행하는 클래스
    
    
###### view 패키지
	- InputView : 사용자가 입력할 값을 관리하는 클래스
	- OutputView : 사용자의 화면에서 메시지와 결과 출력을 관리하는 클래스
	- OutputMessages : view에서 사용하는 메시지와 출력 형태를 관리하는 enum 클래스
   
   
###### validator 패키지
	- Validator : 사용자가 입력한 값이나 프로그램의 동작과정에서 해당 과정이 올바르게 수행되었는지 확인하는 클래스
   
   
###### utils 패키지
	- Pair : C/C++에서 제공하는 pair 객체를 구현한 클래스. 이 프로그램에서는 범위를 표현하기 위해 pair 객체로 사용하였다.
	- LottoNumbersGenerator : 로또 번호를 생성하는 클래스
	- Parser : 입력받은 당첨 번호를 분리하여 정수 배열로 반환하는 클래스
	- Converter : 변수의 타입을 변경하는 클래스
	- LottoFactory : 사용자의 입력한 값에 따른 로또를 생성하는 클래스

###### model 패키지
	- Lotto : 로또 객체 및 로또에서 수행할 메서드를 담당하는 클래스
	- Status : 로또 프로그램을 실행하면서 저장해야할 값을 담당하는 클래스
	- LottoResult : 로또의 등수와 그에 따른 상금을 가지고 있고 출력 형태를 관리하는 enum 클래스
   
* * *